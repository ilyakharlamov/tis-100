@0
P:MOV UP DOWN
   MOV DOWN ACC
   JEZ P
R:MOV LEFT RIGHT
  SUB 1
  JGZ R
MOV RIGHT ACC
ADD 1
MOV ACC RIGHT
MOV DOWN ACC
L: MOV RIGHT LEFT
   SUB 1
   JGZ L

@1
INI:MOV 15 ACC
IN0:MOV 0 UP
    SUB 1
    JGZ IN0
MOV 1 RIGHT

CNT:!MOV RIGHT ACC
CN0:MOV UP DOWN
    SUB 1
    JGZ CN0

@2
FLLD:MOV LEFT NIL
L0: MOV UP ACC
    MOV ACC UP
    JEZ NTFL
    MOV ACC UP
    JMP L0
NTFL:MOV 15 LEFT

@3


@4
    MOV 15 ACC
L0: SWP
    MOV UP ACC
    MOV ACC RIGHT
    MOV ACC RIGHT
    SWP
    MOV ACC RIGHT
    SUB 1
    JGZ L0
MOV -1 RIGHT

@5
VAL:MOV LEFT ACC
   JLZ OUT
   !SUB RIGHT
   JGZ NEW
   MOV LEFT NIL
   MOV LEFT NIL
   MOV RIGHT RIGHT
   JMP VAL
OUT:SWP
    MOV ACC DOWN
    JMP VAL
NEW:MOV RIGHT NIL
    MOV LEFT RIGHT
    MOV LEFT ACC
    SWP

@6
MOV 0 LEFT
MOV 0 LEFT
VLI:MOV LEFT ACC
    MOV ACC LEFT
    MOV ACC LEFT
JMP VLI