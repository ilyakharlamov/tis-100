@0
PUL:MOV UP ACC
    JEZ SIZ
    MOV ACC RIGHT
    SWP
    ADD 1
    SWP
    JMP PUL
SIZ:SWP
    MOV ACC DOWN
    MOV DOWN NIL
    JMP PUL

@1
MOV DOWN LEFT

@2
INI:MOV 999 DOWN
L0: MOV RIGHT ACC
    JGZ CNT
    MOV DOWN RIGHT
    MOV DOWN NIL
    JMP INI
CNT:SUB DOWN
    JGZ OLD
NEW:ADD DOWN
STR:MOV ACC RIGHT
    MOV ACC DOWN
    JMP L0
OLD:MOV DOWN ACC
    JMP STR

@3
S:  MOV UP ACC
    MOV ACC RIGHT
    SAV
RWD:MOV RIGHT LEFT
    MOV LEFT NIL
    SUB 1
    JGZ RWD
MIN:MOV 0 LEFT
    MOV LEFT RIGHT
    SWP
    SUB 1
    MOV ACC RIGHT
    SAV
    JGZ RWD
    MOV -1 UP

@4
CNT:MOV LEFT ACC
DWN:MOV ACC DOWN
    JEZ CNT
DW0:SWP
    MOV UP ACC
    MOV ACC LEFT
    MOV ACC DOWN
    SWP
    SUB 1
    JGZ DW0
MIN:MOV LEFT ACC
    MOV ACC RIGHT
    MOV ACC DOWN
    MOV RIGHT NIL
    SWP

@5
MIN:MOV LEFT ACC
    SWP
CNT:MOV DOWN ACC
KIP:MOV DOWN NIL
    MOV DOWN NIL
    JEZ SKP
ITM:SUB 1
    SWP
    SUB DOWN
    JEZ KIP
    MOV DOWN UP
    ADD DOWN
SKP:SWP
    JGZ ITM
    MOV -1 LEFT

@6
MOV UP ACC
MOV ACC UP
MOV ACC UP

@7
S:  MOV UP ACC
    JEZ ZER
MOV ACC RIGHT
SAV
L0: MOV UP LEFT
    SUB 1
    JGZ L0
MIN:MOV UP DOWN
SWP
L1: MOV LEFT RIGHT
    SUB 1
    JGZ L1
    JMP S
ZER: MOV ACC DOWN

@8
MOV LEFT ACC
MOV ACC UP
MOV ACC UP
MOV ACC UP